{
    "contents" : "---\ntitle: 'Reproducible Research: Assignment 1'\nauthor: \"qpxu007\"\ndate: \"Aug-6-2015\"\noutput:\n  html_document:\n    keep_md: yes\n  pdf_document: default\n---\n\n## Summary\n\nIn this excercise, we will perform exploratory data analysis of pedometer data collected for a person  during a period of two months. Each data point corresponds to the number of steps taken every five minute interval. The analysis code and results are shown in Rmarkdown, which can then be converted to html and pdf for distribution. \n\n## Loading and preprocessing the data\n\nWe first load the data into a dataframe (df) and change the date column to the type Date. The *str* function provides a brief summary of the resulting data.\n\n```{r}\ndf <- read.csv(\"activity.csv\",na.strings = \"NA\", sep=',')\ndf$date <- as.Date(df$date)\nstr(df)\n```\n\n## What is mean total number of steps taken per day?\n\nWe *aggregate* the number of steps in df (with sum) by day (i.e. for each day, we sum up the steps). The column names of the resulting dataframe stepsbyday are reassigned. We can then make a histogram of the total number of steps taken each day, which shows a distribution of steps per day.  \n\n```{r}\nstepsbyday <- aggregate(df$steps, by=list(df$date), FUN=sum, na.rm=TRUE)\ncolnames(stepsbyday)<-c(\"date\",\"steps\")\nhist(stepsbyday$steps, xlab=\"Total steps per day\", \n     main=\"Distribution of total steps per day\")\n```\n\nWe can calculate the mean and median of \"total number of steps taken per day\" using the *summary* function on the steps column of the stepsbyday dataframe.\n\n```{r}\nsummary(stepsbyday$steps,na.rm = T)\n```\n\n## What is the average daily activity pattern?\n\nTo make a time series plot (i.e. type = \"l\") of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis). We can aggreate df (with mean) by interval:\n\n\n```{r}\nmeanperinterval <- aggregate(df$steps, by=list(df$interval), FUN=mean, na.rm=TRUE)\ncolnames(meanperinterval)<-c(\"interval\",\"steps\")\nplot(meanperinterval$steps~meanperinterval$interval, type='l', \n     xlab=\"Time of the day\", ylab=\"<Steps>\", \n     main=\"Average steps  per 5-min interval, averaged for all days in 2-month\")\n```\n\nWe can get the maximum average steps per 5-minute interval, on average across all the days in the dataset, from the plot above. To get the exact number (835), so most activity occured in the morning (8:35am)\n\n```{r}\ni<-which(meanperinterval$steps==max(meanperinterval$steps))\nmeanperinterval[i,]$interval\n```\n\n## Imputing missing values\n\nTo check for total number of rows with NA's, we can use the *summary* function again, or use is *is.na* function.  \n\n```{r}\nsummary(df)\nsum(is.na(df))\n```\n\nIn our analysis above, we ignored NA values. We could try to fill in the missing values, for example, by using the average of the corresponding interval average:\n\n```{r}\ndfi<-merge(df, meanperinterval, by.x=\"interval\", by.y=\"interval\")\ndfi$steps_imputed  <- ifelse(is.na(dfi$steps.x), dfi$steps.y, dfi$steps.x)\nstepsbyday_i1 <- aggregate(dfi$steps_imputed, by=list(dfi$date), FUN=sum)\ncolnames(stepsbyday_i1)<-c(\"date\",\"steps_imputed\")\nhist(stepsbyday_i1$steps_imputed, xlab=\"Total steps per day\", \n     main=\"Distribution of total steps per day (Imputed data with interval average)\")\nsummary(stepsbyday_i1$steps_imputed)\n```\n\nWe can see little change in median, but the mean is increased by about 15%.\n\nWe can also try a more sophisticated algorithm, such as the bootstrap expectation-maximization algorithm implemented in the package Amelia (we will use m=1 for convenience here).\n\n```{r}\nrequire(Amelia)\ndf_imputed <- amelia(df, m=1)$imputations$imp1\n```\n\nNow we can plot the histogram for steps per day, and compare it to that of the original:\n\n```{r}\nstepsbyday_i <- aggregate(df_imputed$steps, by=list(df_imputed$date), FUN=sum)\ncolnames(stepsbyday_i)<-c(\"date\",\"steps\")\nhist(stepsbyday_i$steps, xlab=\"Total steps per day\", \n     main=\"Distribution of total steps per day (Imputed data)\")\nsummary(stepsbyday_i$steps)\n```\n\nWe can see that the histogram, mean, median look quite similar to those of the mean imputed data. \n\n## Are there differences in activity patterns between weekdays and weekends?\n\nTo answer this question, we can create a boxplot of the dataframe stepsbyday, aggregrated by weekday. \n\n```{r}\nstepsbyday$weekday<- weekdays(stepsbyday$date, abbreviate = T)\nboxplot(steps~weekday, data=stepsbyday)\n```\n\nAs shown above, we see no significant difference in activity during weekends and weekdays (at the day level). \n\nAlternatively,  we can plot time series for weekdays and weekends (see time series plot above), first we add a new column weekday, by first translating the date into Sun-Sat, then converting it to a two-factor variable (Weekends or Weekdays).\n\n```{r}\ndf$weekday <- ifelse ( weekdays(df$date, abbreviate=T) %in% \n                         c(\"Sat\", \"Sun\"), \"Weekends\", \"Weekdays\")\ntimeseries <- aggregate(df$steps, by=list(df$interval, df$weekday), \n                        FUN=mean, na.rm=T)\ncolnames(timeseries)<-c(\"interval\",\"weekday\",\"steps\")\nlibrary(lattice)\nxyplot(steps ~ interval | weekday, data = timeseries, layout = c(1,2), type='l')\n```\n\nTo more clearly see the difference, we can superimpose the two lines:\n\n```{r}\nlibrary(ggplot2)\nggplot(data=timeseries, aes(x=interval,y=steps))+geom_line(aes(colour=weekday), size=1)\n```\n\n",
    "created" : 1438815785184.000,
    "dirty" : false,
    "encoding" : "ISO8859-1",
    "folds" : "",
    "hash" : "373516997",
    "id" : "4CB792E4",
    "lastKnownWriteTime" : 1438879099,
    "path" : "E:/R-classes/RepData/as1/PA1_template.Rmd",
    "project_path" : "PA1_template.Rmd",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_markdown"
}